{
    "version": "https://jsonfeed.org/version/1",
    "title": "null • All posts by \"nginx\" tag",
    "description": "欢迎来到Piggy的笔记空间~这里主要会记录一些随笔🌸",
    "home_page_url": "https://piggy926.github.io",
    "items": [
        {
            "id": "https://piggy926.github.io/2023/11/06/linux/nginx-location/",
            "url": "https://piggy926.github.io/2023/11/06/linux/nginx-location/",
            "title": "nginx location块配置中斜杠\"/\"的路径匹配规则",
            "date_published": "2023-11-06T06:35:16.000Z",
            "content_html": "<h1 id=\"前言\"><a class=\"markdownIt-Anchor\" href=\"#前言\">#</a> 前言</h1>\n<h1 id=\"nginx规则分类\"><a class=\"markdownIt-Anchor\" href=\"#nginx规则分类\">#</a> nginx 规则分类</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>nginx规则分类</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>＝   精确匹配                   （优先级最高）<span class=\"token comment\"># 只匹配根目录结尾的请求，后面不能带任何字符串</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>^~   精确前缀匹配               （优先级仅次于<span class=\"token operator\">=</span>）</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>~    区分大小写的正则匹配       （优先级次于^~）</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>~*   不区分大小写的正则匹配     （优先级次于^~）</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>/uri 普通前缀匹配               （优先级次于正则）<span class=\"token comment\"># 最常用</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>/    通用匹配                   （优先级最低）<span class=\"token comment\"># 默认匹配路径</span></pre></td></tr></table></figure><h1 id=\"下面是测试location块中的匹配案例\"><a class=\"markdownIt-Anchor\" href=\"#下面是测试location块中的匹配案例\">#</a> 下面是测试 location 块中 &quot; <code>/</code> &quot; 的匹配案例</h1>\n<div class=\"note primary\">\n<p>前置测试访问域名：<span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMS9hcGkvdGVzdA==\">http://127.0.0.1/api/test</span></p>\n</div>\n<hr>\n<h2 id=\"location和proxy_pass都不带则真实地址会带location匹配目录api\"><a class=\"markdownIt-Anchor\" href=\"#location和proxy_pass都不带则真实地址会带location匹配目录api\">#</a> location 和 proxy_pass <code>都不带/</code> ，则真实地址会带 location 匹配目录 /api/</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>location配置</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>location /api <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     proxy_pass http://127.0.0.1:8080<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>最终访问地址： <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMQ==\">http://127.0.0.1</span><span class=\"pink\">/api/test</span> --&gt; <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMTo4MDgw\">http://127.0.0.1:8080</span><span class=\"pink\">/api/test</span></p>\n</div>\n<hr>\n<h2 id=\"location带proxy_pass不带则真实地址会带location匹配目录api\"><a class=\"markdownIt-Anchor\" href=\"#location带proxy_pass不带则真实地址会带location匹配目录api\">#</a> location <code>带/</code> ，proxy_pass <code>不带/</code> ，则真实地址会带 location 匹配目录 /api/</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>location配置</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>location /api/ <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     proxy_pass http://127.0.0.1:8080<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>最终访问地址： <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMQ==\">http://127.0.0.1</span><span class=\"pink\">/api/test</span> --&gt; <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMTo4MDgw\">http://127.0.0.1:8080</span><span class=\"pink\">/api/test</span></p>\n</div>\n<hr>\n<h2 id=\"location不带proxy_pass带则真实地址会带\"><a class=\"markdownIt-Anchor\" href=\"#location不带proxy_pass带则真实地址会带\">#</a> location <code>不带/</code> ，proxy_pass <code>带/</code> ，则真实地址会 <code>带/</code></h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>location配置</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>location /api <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    proxy_pass http://127.0.0.1:8080/<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>最终访问地址：<span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMQ==\">http://127.0.0.1</span><span class=\"pink\">/api/test</span> --&gt; <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMTo4MDgw\">http://127.0.0.1:8080</span><span class=\"pink\">//test</span></p>\n</div>\n<hr>\n<h2 id=\"location和proxy_pass都带则真实地址不带location匹配目录\"><a class=\"markdownIt-Anchor\" href=\"#location和proxy_pass都带则真实地址不带location匹配目录\">#</a> location 和 proxy_pass <code>都带/</code> ，则真实地址不带 location 匹配目录</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>location配置</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>location /api/ <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    proxy_pass http://127.0.0.1:8080/<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>最终访问地址：<span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMQ==\">http://127.0.0.1</span><span class=\"pink\">/api/test</span> --&gt; <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMTo4MDgw\">http://127.0.0.1:8080</span><span class=\"pink\">/test</span></p>\n</div>\n<hr>\n<h2 id=\"同1location和proxy_pass都不带但-proxy_pass带地址则真实地址匹配地址会替换location匹配目录\"><a class=\"markdownIt-Anchor\" href=\"#同1location和proxy_pass都不带但-proxy_pass带地址则真实地址匹配地址会替换location匹配目录\">#</a> 同 1，location 和 proxy_pass <code>都不带/</code> ，但 proxy_pass <code>带地址</code> ，则真实地址匹配地址会替换 location 匹配目录</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>location配置</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>location /api <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     proxy_pass http://127.0.0.1:8080/server<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>最终访问地址： <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMQ==\">http://127.0.0.1</span><span class=\"pink\">/api/test</span> --&gt; <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMTo4MDgw\">http://127.0.0.1:8080</span><span class=\"pink\">/server/test</span></p>\n</div>\n<hr>\n<h2 id=\"同2location带proxy_pass不带但-proxy_pass带地址则真实地址会直接连起来\"><a class=\"markdownIt-Anchor\" href=\"#同2location带proxy_pass不带但-proxy_pass带地址则真实地址会直接连起来\">#</a> 同 2，location <code>带/</code> ，proxy_pass <code>不带/</code> ，但 proxy_pass <code>带地址</code> ，则真实地址会直接连起来</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>location配置</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>location /api/ <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     proxy_pass http://127.0.0.1:8080/server<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>最终访问地址： <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMQ==\">http://127.0.0.1</span><span class=\"pink\">/api/test</span> --&gt; <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMTo4MDgw\">http://127.0.0.1:8080</span><span class=\"pink\">/servertest</span></p>\n</div>\n<hr>\n<h2 id=\"同2location不带proxy_pass带但-proxy_pass带地址则真实地址会多个\"><a class=\"markdownIt-Anchor\" href=\"#同2location不带proxy_pass带但-proxy_pass带地址则真实地址会多个\">#</a> 同 2，location <code>不带/</code> ，proxy_pass <code>带/</code> ，但 proxy_pass <code>带地址</code> ，则真实地址会多个 <code>/</code></h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>location配置</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>location /api <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     proxy_pass http://127.0.0.1:8080/server/<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>最终访问地址： <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMQ==\">http://127.0.0.1</span><span class=\"pink\">/api/test</span> --&gt; <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMTo4MDgw\">http://127.0.0.1:8080</span><span class=\"pink\">/server//test</span></p>\n</div>\n<hr>\n<h2 id=\"同4location和proxy_pass都带但-proxy_pass带地址\"><a class=\"markdownIt-Anchor\" href=\"#同4location和proxy_pass都带但-proxy_pass带地址\">#</a> 同 4，location 和 proxy_pass <code>都带/</code> ，但 proxy_pass <code>带地址</code></h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>location配置</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>location /api/ <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>     proxy_pass http://127.0.0.1:8080/server/<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><div class=\"note info\">\n<p>最终访问地址： <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMQ==\">http://127.0.0.1</span><span class=\"pink\">/api/test</span> --&gt; <span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMTo4MDgw\">http://127.0.0.1:8080</span><span class=\"pink\">/server/test</span></p>\n</div>\n<hr>\n<h1 id=\"总结\"><a class=\"markdownIt-Anchor\" href=\"#总结\">#</a> 总结</h1>\n<ol>\n<li>proxy_pass 代理地址端口后<ins class=\"wavy\">有目录</ins> (包括 <code>/</code> )，则 <code>去除location</code>  匹配目录</li>\n<li>proxy_pass 代理地址端口后无任何，转发后地址：代理地址 + 访问 URL 目录部</li>\n</ol>\n",
            "tags": [
                "nginx"
            ]
        }
    ]
}